<!DOCTYPE html>
<html>

<head>
  <title>Shake the Piggy Bank</title>
  <script src="jspsych/jspsych.js"></script>
  <script src="jspsych/plugin-html-keyboard-response.js"></script>
  <script src="jspsych/plugin-html-button-response.js"></script>
  <link href="jspsych/jspsych.css" rel="stylesheet" type="text/css" />
  <link href="vigour_styles.css" rel="stylesheet" type="text/css" />
  <script src="vigour_instructions.js"></script>
  <script src="vigour.js"></script>
</head>

<body>
  <div id="jspsych-content"></div>
  <script>
    const jsPsych = initJsPsych({
      on_finish: function () {
        jsPsych.data.displayData();
      }
    });

    // Get condition from URL, all caps are prolific, lowercase are ours
    try {
      window.prolificPID = data.getURLVariable('PROLIFIC_PID');
    } catch (error) {
      window.prolificPID = "debug";
    }
    window.simulate = prolificPID.includes("simulate");
    // window.debug = prolificPID.includes("debug");
    // window.studyId = jsPsych.data.getURLVariable('STUDY_ID');
    // window.sessionId = jsPsych.data.getURLVariable('SESSION_ID');
    // window.sessionNum = jsPsych.data.getURLVariable('session_num');

    // Save participant variables to data
    jsPsych.data.addProperties({
      prolific_pid: window.prolificPID,
      // study_id: window.studyId,
      // session_id: window.sessionId,
      // session: window.sessionNum,
      n_warnings: 0
    })

    // Combine all parts into the full timeline
    const fullTimeline = [
      instructionPage,
      startFirstTrial,
      ...experimentTimeline,
      debriefing
    ];

    // Run the experiment
    if (window.simulate) {
      jsPsych.simulate(fullTimeline, "visual");
    } else {
    jsPsych.run(fullTimeline);
    }
  </script>
</body>

</html>